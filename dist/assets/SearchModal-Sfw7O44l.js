import{j as e,w as E,P as M,I as C,C as I,y as P,B as c,T as n,r,a1 as Q,a2 as W,c as O,S as U,a3 as q,a4 as z,a5 as J,a6 as X}from"./index-DysBYLEK.js";import{I as D}from"./Input-T5PU5wjL.js";import{T as G,a as A}from"./Tabs-Bk0UedCL.js";import{L as _}from"./ListItemAvatar-BbWoKd1N.js";const K=({open:h,onClose:a,hub:t,onSearchClose:p})=>{const i=()=>{p()};return e.jsx(E,{open:h,onClose:a,children:e.jsxs(M,{sx:{position:"relative",width:"100%",maxWidth:"500px",bgcolor:"background.paper",borderRadius:2,p:3},children:[e.jsx(C,{onClick:a,sx:{position:"absolute",right:8,top:8,color:"text.secondary"},children:e.jsx(I,{})}),e.jsxs(P,{spacing:3,children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[t.avatar&&e.jsx(c,{component:"img",src:t.avatar,alt:t.name,sx:{width:64,height:64,borderRadius:"50%",objectFit:"cover"}}),e.jsxs(c,{children:[e.jsx(n,{variant:"h6",component:"h2",children:t.name}),t.description&&e.jsx(n,{variant:"body2",color:"text.secondary",children:t.description})]})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(C,{onClick:a,sx:{color:"text.secondary","&:hover":{color:"text.primary"}},children:e.jsx(I,{})}),e.jsx(Button,{onClick:i,variant:"contained",sx:{background:"linear-gradient(90deg, #FF69B4 0%, #1E90FF 100%)",color:"#fff",fontWeight:"bold","&:hover":{background:"linear-gradient(90deg, #FF1493 0%, #00BFFF 100%)"}},children:"Join Hub"})]})]})]})})},$=({open:h,onClose:a})=>{const[t,p]=r.useState(0),[i,l]=r.useState([]),[d,F]=r.useState(""),[u,k]=r.useState(""),[o,g]=r.useState(0),[b,v]=r.useState(null),x=r.useRef(null),f=r.useCallback(Q.debounce(s=>{k(s),g(0),l([])},500),[]);r.useEffect(()=>(f(d),()=>{f.cancel()}),[d,f]);const{data:m,isFetching:R}=W(u.trim(),{skip:!u.trim()||t!==0,refetchOnMountOrArgChange:!1}),{data:j,isFetching:T}=O({name:u.trim(),page:o,size:20,sort:"createdAt,desc"},{skip:!u.trim()||t!==1,refetchOnMountOrArgChange:!1}),y=r.useCallback(()=>{if(!x.current)return;const{scrollTop:s,scrollHeight:B,clientHeight:w}=x.current;B-s<=w+100&&g(L=>L+1)},[]);r.useEffect(()=>{const s=x.current;if(s)return s.addEventListener("scroll",y),()=>s.removeEventListener("scroll",y)},[y]),r.useEffect(()=>{l(t===0?s=>o===0?m||[]:[...s,...m||[]]:s=>o===0?j||[]:[...s,...j||[]])},[t,m,j,o]);const S=t===0?R:T,H=s=>{v(s)};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{open:h,onClose:a,title:"Поиск",children:[e.jsxs(G,{value:t,onChange:(s,B)=>{p(B),l([]),F(""),k(""),g(0)},centered:!0,sx:{mb:3,"& .MuiTabs-indicator":{display:"none"},"& .MuiTab-root":{position:"relative","&::after":{content:'""',position:"absolute",bottom:0,left:0,right:0,height:"3px",background:"linear-gradient(90deg, #FF69B4 0%, #1E90FF 100%)",opacity:0,transition:"opacity 0.3s ease, transform 0.3s ease",transform:"scaleX(0)"},"&.Mui-selected::after":{opacity:1,transform:"scaleX(1)"}}},children:[e.jsx(A,{label:"Пользователи",sx:{color:t===0?"#FF69B4":"#B0B0B0",fontWeight:700}}),e.jsx(A,{label:"Хабы",sx:{color:t===1?"#1E90FF":"#B0B0B0",fontWeight:700}})]}),e.jsx(D,{name:"query",placeholder:t===0?"Введите логин пользователя...":"Введите название хаба...",value:d,onChange:s=>F(s.target.value),InputProps:{startAdornment:e.jsx(U,{sx:{color:t===0?"#FF69B4":"#1E90FF",mr:1}})}}),S&&o===0?e.jsx(n,{sx:{color:"#B0B0B0",textAlign:"center",mt:3},children:"Поиск..."}):i.length>0?e.jsxs(q,{ref:x,sx:{maxHeight:"400px",overflow:"auto","&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{background:"rgba(255,255,255,0.1)",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{background:"rgba(255,255,255,0.2)",borderRadius:"4px","&:hover":{background:"rgba(255,255,255,0.3)"}}},children:[i.map(s=>e.jsx(z,{onClick:()=>t===1&&H(s),sx:{display:"flex",alignItems:"center","&:hover":{background:"rgba(255,255,255,0.05)",borderRadius:1},cursor:"pointer",transition:"all 0.2s ease"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(_,{children:e.jsx(J,{src:s.avatar,sx:{bgcolor:t===0?"rgba(255,105,180,0.2)":"rgba(30,144,255,0.2)",color:t===0?"#FF69B4":"#1E90FF"},children:t===0?s.login.charAt(0).toUpperCase():s.name.charAt(0).toUpperCase()})}),e.jsx(X,{primary:t===0?s.login:s.name,primaryTypographyProps:{sx:{color:"#fff",fontWeight:500}},secondary:t===0?s.status||"":String(s.type)==="0"?"Приватный":"Публичный",secondaryTypographyProps:{sx:{color:"#B0B0B0",fontSize:"0.75rem"}}})]})},s.id)),S&&o>0&&e.jsx(n,{sx:{color:"#B0B0B0",textAlign:"center",py:2},children:"Загрузка..."})]}):d?e.jsx(n,{sx:{color:"#B0B0B0",textAlign:"center",mt:3},children:"Ничего не найдено"}):e.jsx(n,{sx:{color:"#B0B0B0",textAlign:"center",mt:3},children:t===0?"Введите логин пользователя для поиска":"Введите название хаба для поиска"})]}),b&&e.jsx(K,{open:!!b,onClose:()=>v(null),hub:b,onSearchClose:a})]})};export{$ as S};
