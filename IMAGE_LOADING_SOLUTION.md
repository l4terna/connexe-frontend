# üöÄ –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üí° **–ü—Ä–æ–±–ª–µ–º–∞**
- –ú–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥–∏–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
- –ë—Ä–∞—É–∑–µ—Ä –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –æ–¥–Ω–æ–º—É –¥–æ–º–µ–Ω—É
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**
**Service Worker + –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤** –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üîß **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

### 1. **Service Worker** (`service-worker-simple.ts`)
```typescript
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (/api/v1/media/)
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (max 3)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –æ—á–µ—Ä–µ–¥—å—é –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ
- –ù–ï –∫–µ—à–∏—Ä—É–µ—Ç (–ø–æ –≤–∞—à–µ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)
```

### 2. **Image Queue** (`imageQueue-simple.ts`)  
```typescript
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–≥—Ä—É–∑–∫–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏ (2G/3G/4G)
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å –Ω–∏–∑–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
```

### 3. **AuthorizedImage Component**
```typescript
- –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ imageQueue.loadImage()
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Object URLs
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏
```

---

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

### ‚úÖ **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã**
- Service Worker —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π JavaScript –ø–æ—Ç–æ–∫
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å UI

### ‚úÖ **–£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
- –ú–∞–∫—Å–∏–º—É–º 3 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

### ‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã**
```typescript
// –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
<AuthorizedImage storageKey="important" priority={10} />

// –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ - –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
imageQueue.preloadImages(['img1', 'img2'], -1);
```

### ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- –û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## üìä **Debug –ø–∞–Ω–µ–ª—å**

–í dev —Ä–µ–∂–∏–º–µ –∫–Ω–æ–ø–∫–∞ "üñºÔ∏è Debug" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –î–ª–∏–Ω—É –æ—á–µ—Ä–µ–¥–∏
- –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã  
- –¢–∏–ø —Å–µ—Ç–∏ (2G/3G/4G)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏

**–ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```javascript
window.imageDebugger.getStats()  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
window.clearImageLogs()          // –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
imageQueue.cancelAll()           // –û—Ç–º–µ–Ω–∏—Ç—å –æ—á–µ—Ä–µ–¥—å
```

---

## üöÄ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**

### –ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:
```typescript
<AuthorizedImage 
  storageKey="image-key-123"
  priority={0}  // –æ–±—ã—á–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
/>
```

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
```typescript
<AuthorizedImage 
  storageKey="avatar-image"
  priority={10}  // –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
/>
```

### –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞:
```typescript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —á–∞—Ç–∞
useEffect(() => {
  const imageKeys = messages
    .flatMap(msg => msg.attachments || [])
    .slice(0, 10); // –ø–µ—Ä–≤—ã–µ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    
  imageQueue.preloadImages(imageKeys, -1);
}, [messages]);
```

---

## üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

### **–ë—ã–ª–æ:**
- ‚ùå –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥—Ä—É–≥–∏—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤  
- ‚ùå –ù–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏
- ‚ùå –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### **–°—Ç–∞–ª–æ:**
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 3 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ Service Worker
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ—á–µ—Ä–µ–¥—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã
- ‚úÖ –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏

---

## üîó **–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**

```
src/
‚îú‚îÄ‚îÄ service-worker-simple.ts      # Service Worker
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ imageQueue-simple.ts      # –û—á–µ—Ä–µ–¥—å –∑–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ debugTools.ts             # –û—Ç–ª–∞–¥–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ api.config.ts             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è URL
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ debug/ImageDebugPanel.tsx # Debug –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ hub/chat/components/
‚îÇ       ‚îî‚îÄ‚îÄ AuthorizedImage.tsx   # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ vite.config.ts               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Service Worker
```

---

## üéõÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
```typescript
// –í service-worker-simple.ts
const MAX_CONCURRENT_REQUESTS = 3; // –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

### –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–µ—Ç–∏:
```typescript
// –í imageQueue-simple.ts –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
// 4G -> 4 –∑–∞–ø—Ä–æ—Å–∞
// 3G -> 2 –∑–∞–ø—Ä–æ—Å–∞  
// 2G -> 1 –∑–∞–ø—Ä–æ—Å
```

### URL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```typescript
// –í .env
VITE_API_URL=https://your-api.com/api/v1

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç proxy –≤ dev —Ä–µ–∂–∏–º–µ
```

---

## üèÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å **–ø—Ä–æ—Å—Ç–æ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

1. **–ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç** –¥—Ä—É–≥–∏–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
2. **–£–ø—Ä–∞–≤–ª—è–µ—Ç** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
3. **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–µ—Ç** –≤–∞–∂–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
4. **–ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è** –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏
5. **–ù–∞–¥–µ–∂–Ω–æ** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
6. **–õ–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è** –≤ dev —Ä–µ–∂–∏–º–µ

**–ë–µ–∑ —Å–ª–æ–∂–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** - –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –≤—ã —Ö–æ—Ç–µ–ª–∏! üéâ